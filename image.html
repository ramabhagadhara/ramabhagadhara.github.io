<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Bootstrap demo</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-KK94CHFLLe+nY2dmCWGMq91rCGa5gtU4mk92HdvYe+M/SXH301p5ILy+dN9+nJOZ" crossorigin="anonymous">
    <link rel="stylesheet" href="main.css" type="text/css">
  </head>
  <body>
    <div class="container-sm">
        <figure class="text-center">
            <blockquote class="blockquote">
              <p>Silahkan masukan Gambar yang anda pilih</p>
            </blockquote>
            <figcaption class="blockquote-footer">
                Selamat menikmati aplikasi kami
            </figcaption>
          </figure>
          <button onclick="window.location.href='index.html'" class="btn btn-primary" type="button">kembali</button>
           <div class="input-container">
            <label for="inputImage">Pilih Gambar:</label>
            <input type="file" class="form-control" id="inputImage" accept="image/*">
          </div>
        
          <div class="input-container">
            <label for="maxWidthInput">Lebar Maksimum (px):</label>
            <input type="number" class="form-control" id="maxWidthInput" value="500" min="100" max="2000" step="100">
          </div>
        
          <div class="input-container">
            <label for="maxHeightInput">Tinggi Maksimum (px):</label>
            <input type="number" class="form-control" id="maxHeightInput" value="500" min="100" max="2000" step="100">
          </div>
          <div class="d-flex p-2">
            <button class="btn btn-success" id="compressButton">Kompresi Gambar</button>
            <button class="btn btn-danger" id="removeButton">Hapus Gambar</button>
          </div>
        
        
          <img id="previewImage" alt="Preview Gambar">
    </div>

    <script>
        document.getElementById('compressButton').addEventListener('click', compressImage);

function compressImage() {
  const input = document.getElementById('inputImage');
  const file = input.files[0];

  if (file) {
    const reader = new FileReader();
    reader.onload = function(e) {
      const img = new Image();
      img.src = e.target.result;
      img.onload = function() {
        const canvas = document.createElement('canvas');
        const ctx = canvas.getContext('2d');

        const maxWidth = document.getElementById('maxWidthInput').value;
        const maxHeight = document.getElementById('maxHeightInput').value;
        let width = img.width;
        let height = img.height;

        if (width > maxWidth) {
          height *= maxWidth / width;
          width = maxWidth;
        }

        if (height > maxHeight) {
          width *= maxHeight / height;
          height = maxHeight;
        }

        canvas.width = width;
        canvas.height = height;

        ctx.drawImage(img, 0, 0, width, height);

        const compressedDataURL = canvas.toDataURL('image/jpeg', 0.7);

        const previewImage = document.getElementById('previewImage');
        previewImage.src = compressedDataURL;

        // Mengaktifkan kembali input untuk mengatur ukuran gambar
        document.getElementById('maxWidthInput').disabled = false;
        document.getElementById('maxHeightInput').disabled = false;
      }
    }

    reader.readAsDataURL(file);
  }
}

    // Menambahkan event listener untuk menghapus gambar yang telah dikompresi
    document.getElementById('removeButton').addEventListener('click', removeCompressedImage);

    function removeCompressedImage() {
    const previewImage = document.getElementById('previewImage');
    previewImage.src = '';

    // Mengaktifkan kembali input untuk mengatur ukuran gambar
    document.getElementById('maxWidthInput').disabled = false;
    document.getElementById('maxHeightInput').disabled = false;
    }
    </script>
  </body>
</html>